<!-- -*- mode: nxml -*- -->
<configure
	xmlns="http://namespaces.zope.org/zope"
	xmlns:ext="http://nextthought.com/ntp/ext"
	xmlns:zcml="http://namespaces.zope.org/zcml"
	i18n_domain="zope">

	<include package="zope.component" />

	<!-- Events for keeping replies and referents updated. -->
	<!-- Hidden in dev mode at the moment so that I don't have to deal
	with a partial state during migration. -->
	<subscriber handler=".threadable.threadable_added"
				zcml:condition="have devmode"/>
	<subscriber handler=".threadable.threadable_removed"
				zcml:condition="have devmode"/>

	<!-- Externalization -->
	<include package="nti.externalization" file="meta.zcml" />
	<include package="nti.externalization" />

	<ext:registerMimeFactories module=".note" />
	<ext:registerMimeFactories module=".bookmark" />
	<ext:registerMimeFactories module=".highlight" />
	<ext:registerMimeFactories module=".redaction" />
	<ext:registerMimeFactories module=".canvas" />

	<adapter factory=".bookmark.BookmarkInternalObjectIO" />
	<adapter factory=".canvas.CanvasInternalObjectIO" />
	<adapter factory=".highlight.HighlightInternalObjectIO"/>
	<adapter factory=".note.NoteInternalObjectIO" />
	<adapter factory=".redaction.RedactionInternalObjectIO" />


	<!-- Blob file URL storage for canvas images -->
	<exclude package="zope.file" file="browser.zcml" />
	<include package="zope.file" />

	<include package=".forums" />

</configure>
